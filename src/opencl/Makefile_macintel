CC = clang++
LD = $(CC)

APP = ap26_opencl_macintel64

VPATH = ../common

SRC = AP26.c simpleCL.c simpleCL.h CONST.H checkn.h clearok.h clearsol.h offset.h setupokok.h sieve.h sieve_nv.h
OBJ = AP26.o simpleCL.o

BOINC_DIR = ../../../boinc_707
BOINC_INC = -I$(BOINC_DIR)/api -I$(BOINC_DIR)/lib
BOINC_LIB = -L$(BOINC_DIR)/mac_build/build/Deployment/ -lboinc -lboinc_api -lboinc_opencl -lstdc++

DFLAGS  = -DAP26_BOINC -DAP26_OPENCL
CFLAGS  = -I . -O3 -arch x86_64 -isysroot /Developer/SDKs/MacOSX10.8.sdk -mmacosx-version-min=10.6
LDFLAGS = $(CFLAGS)

all : $(APP)

$(APP) : $(OBJ)
	$(CC) $(CFLAGS) -c -o AP26.o AP26.c
	$(CC) $(CFLAGS) -c -o simpleCL.o simpleCL.c
	$(LD) $(LDFLAGS) -framework OpenCL -o $(APP) AP26.o simpleCL.o

$(APP) : $(OBJ)
	$(LD) $(LDFLAGS) $(BOINC_LIB) -framework OpenCL -o $(APP) $^

AP26.o : $(SRC)
	$(CC) $(DFLAGS) $(CFLAGS) $(BOINC_INC) -c -o $@ AP26.c

simpleCL.o : $(SRC)
	$(CC) $(DFLAGS) $(CFLAGS) $(BOINC_INC) -c -o $@ simpleCL.c

clean :
	rm -f *.o $(APP)

