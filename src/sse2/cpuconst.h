// cpuconst.h - cpu constants

/* These constants were generated with the PARI/GP command:
     forprime(p=61,331,print("#define INV",p," UINT64_C(",2^64\p,")"))
*/
#define INV61 UINT64_C(302405640552615600)
#define INV67 UINT64_C(275324538413575397)
#define INV71 UINT64_C(259813296812810586)
#define INV73 UINT64_C(252695124297391118)
#define INV79 UINT64_C(233503089540627235)
#define INV83 UINT64_C(222249928598910260)
#define INV89 UINT64_C(207266787345051141)
#define INV97 UINT64_C(190172619316593315)
#define INV101 UINT64_C(182641030432767837)
#define INV103 UINT64_C(179094602657374287)
#define INV107 UINT64_C(172399477324388332)
#define INV109 UINT64_C(169236184162472950)
#define INV113 UINT64_C(163245522776190722)
#define INV127 UINT64_C(145249953336295682)
#define INV131 UINT64_C(140814840257324821)
#define INV137 UINT64_C(134647766961383588)
#define INV139 UINT64_C(132710389019493177)
#define INV149 UINT64_C(123803651501406386)
#define INV151 UINT64_C(122163868037811600)
#define INV157 UINT64_C(117495185182863386)
#define INV163 UINT64_C(113170209041162893)
#define INV167 UINT64_C(110459545351554201)
#define INV173 UINT64_C(106628578460748853)
#define INV179 UINT64_C(103054436165975148)
#define INV181 UINT64_C(101915713114417412)
#define INV191 UINT64_C(96579811904238490)
#define INV193 UINT64_C(95578984837873324)
#define INV197 UINT64_C(93638294790403815)
#define INV199 UINT64_C(92697206400550510)
#define INV211 UINT64_C(87425327363552377)
#define INV223 UINT64_C(82720825442643729)
#define INV227 UINT64_C(81263189752024456)
#define INV229 UINT64_C(80553467570784068)
#define INV233 UINT64_C(79170575423646144)
#define INV239 UINT64_C(77183029597111094)
#define INV241 UINT64_C(76542506529915151)
#define INV251 UINT64_C(73493004277727297)
#define INV257 UINT64_C(71777214294589695)
#define INV263 UINT64_C(70139711306880424)
#define INV269 UINT64_C(68575256779589411)
#define INV271 UINT64_C(68069166323651481)
#define INV277 UINT64_C(66594743948409933)
#define INV281 UINT64_C(65646776063023315)
#define INV283 UINT64_C(65182841249857072)
#define INV293 UINT64_C(62958170900032599)
#define INV307 UINT64_C(60087114246610917)
#define INV311 UINT64_C(59314289626075728)
#define INV313 UINT64_C(58935284580541698)
#define INV317 UINT64_C(58191621683626345)
#define INV331 UINT64_C(55730344633563600)

//    forprime(p=337,541,print("#define INV",p," UINT64_C(",2^64\p,")"))
#define INV337 UINT64_C(54738112978366622)
#define INV347 UINT64_C(53160645745560667)
#define INV349 UINT64_C(52856000211202153)
#define INV353 UINT64_C(52257065364616293)
#define INV359 UINT64_C(51383688227603207)
#define INV367 UINT64_C(50263607830271257)
#define INV373 UINT64_C(49455077945602015)
#define INV379 UINT64_C(48672147951740241)
#define INV383 UINT64_C(48163822646761231)
#define INV389 UINT64_C(47420935922132523)
#define INV397 UINT64_C(46465350311610961)
#define INV401 UINT64_C(46001855545410353)
#define INV409 UINT64_C(45102063749901104)
#define INV419 UINT64_C(44025642180691053)
#define INV421 UINT64_C(43816494236839790)
#define INV431 UINT64_C(42799870240625409)
#define INV433 UINT64_C(42602180308798040)
#define INV439 UINT64_C(42019918163347497)
#define INV443 UINT64_C(41640505809728107)
#define INV449 UINT64_C(41084062524965593)
#define INV457 UINT64_C(40364866682077793)
#define INV461 UINT64_C(40014629227135686)
#define INV463 UINT64_C(39841779856824085)
#define INV467 UINT64_C(39500522641776341)
#define INV479 UINT64_C(38510947961815347)
#define INV487 UINT64_C(37878324586672590)
#define INV491 UINT64_C(37569743530976683)
#define INV499 UINT64_C(36967422993405915)
#define INV503 UINT64_C(36673447462643243)
#define INV509 UINT64_C(36241147492553146)
#define INV521 UINT64_C(35406418567580713)
#define INV523 UINT64_C(35271021173440825)
#define INV541 UINT64_C(34097493666745936)


/* evaluates to (N%P), assuming N < 2^(64-S), P < 2^S.
*/
#define REM(_N,_P,_S) \
  (UINT32_C(_P)*(uint32_t)(((INV##_P*((uint64_t)(_N)+1))>>(32+_S))))>>(32-_S)
